create or replace view DB_CDI_DEV_DWH.RDV_MDM_SANDBOX.VW_SAT_MDM_PARTY(
	HK_HUB_PARTY,
	MD_HASHDIFF,
	MD_START_DT,
	MD_END_DT,
	MD_IS_DELETED,
	MD_FILENAME,
	MD_SOURCE,
	MD_CREATION_AUDIT_ID,
	MD_CREATION_DT,
	ID_PARTY,
	CMO_PARTYTYPECODE,
	CMO_GENDERCODE,
	CMO_CIVILSTATUSCODE,
	CMO_DATEOFBIRTH,
	CMO_DATEOFDEATH,
	CMO_ISDECEASED,
	CMO_EDUCATIONCODE,
	CMO_EMPLOYER,
	CMO_GLOBALCONSENTVALUECODE,
	CMO_GLOBALCONSENTRECEIVEDDATE,
	CMO_FISCALYEARENDMONTHCODE,
	CMO_FISCALYEARENDDAY,
	CMO_CREATIONDATE,
	CMO_BUSINESSENTITYCODE,
	CMO_JOBTITLE,
	CMO_ORGANIZATIONTYPECODE
) as SELECT 
  HK_HUB_PARTY,
	MD_HASHDIFF,
	MD_START_DT,
  NVL(LEAD(DATEADD(millisecond, -1, MD_START_DT), 1) OVER (PARTITION BY HK_HUB_PARTY ORDER BY MD_START_DT ASC, MD_CREATION_DT ASC), '9999-12-31 23:59:59.9999'::timestamp_ntz(9)) AS MD_END_DT,
	MD_IS_DELETED,
	MD_FILENAME,
	MD_SOURCE,
	MD_CREATION_AUDIT_ID,
	MD_CREATION_DT,
	ID_PARTY,
	CMO_PARTYTYPECODE,
	CMO_GENDERCODE,
	CMO_CIVILSTATUSCODE,
	CMO_DATEOFBIRTH,
	CMO_DATEOFDEATH,
	CMO_ISDECEASED,
	CMO_EDUCATIONCODE,
	CMO_EMPLOYER,
	CMO_GLOBALCONSENTVALUECODE,
	CMO_GLOBALCONSENTRECEIVEDDATE,
	CMO_FISCALYEARENDMONTHCODE,
	CMO_FISCALYEARENDDAY,
	CMO_CREATIONDATE,
	CMO_BUSINESSENTITYCODE,
	CMO_JOBTITLE,
	CMO_ORGANIZATIONTYPECODE
FROM DB_CDI_DEV_DWH.RDV_MDM_SANDBOX.SAT_MDM_PARTY;
